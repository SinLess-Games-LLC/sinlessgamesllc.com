// For format details, see https://aka.ms/devcontainer.json. For config options, see the
// README at: https://github.com/devcontainers/templates/tree/main/src/debian
{
  "name": "SinLess Games LLC Website Dev Container",
  // Or use a Dockerfile or Docker Compose file. More info: https://containers.dev/guide/dockerfile
  "build": {
    "dockerfile": "./Dockerfile"
    // "dockerComposeFile": "",
  },
  "containerEnv": {},
  "remoteEnv": {},
  // Privlaged is required to run sudo
  "privileged": true,
  "postCreateCommand": {
    "clone zsh-autosuggestions": "git clone https://github.com/zsh-users/zsh-autosuggestions /home/node/.oh-my-zsh/custom/plugins/zsh-autosuggestions",
    "clone zsh-syntax-highlighting": "git clone https://github.com/zsh-users/zsh-syntax-highlighting.git /home/node/.oh-my-zsh/custom/plugins/zsh-syntax-highlighting",
    "clone envrc plugin": "curl --create-dirs -o /home/node/.oh-my-zsh/custom/plugins/envrc/envrc.plugin.zsh https://raw.githubusercontent.com/fabiogibson/envrc-zsh-plugin/master/envrc.plugin.zsh",
    "add gpg key": "cp ./.devcontainer/gpg-pubkey ~/.gnupg/pub.gpg", // this can not be in the same command list as the changing permissions
    "zshrc": "cp ./.devcontainer/.zshrc ~/.zshrc"
  },
  "postStartCommand": {
    "initialize project": "task init",
    "git config": "git config --global user.email \"disdainful777@gmail.comn\" && git config --global user.name \"Sinless777\"",
    // sudo is required to change permissions
    "change perms": "sudo chmod 600 ~/.gnupg/pub.gpg",
    "import gpg": "gpg --import ~/.gnupg/pub.gpg"
  },
  "postAttachCommand": {
    // "Source zshrc": "source ~/.zshrc"
  },
  // Features to add to the dev container. More info: https://containers.dev/features.
  "features": {
    "ghcr.io/devcontainers/features/github-cli:1": {},
    "ghcr.io/devcontainers-contrib/features/go-task:1": {},
    /**
     * Common utils
     * - zsh
     * - go-task
     */
    "ghcr.io/devcontainers/features/common-utils:2": {
      "configureZshAsDefaultShell": true,
      "installOhMyZshConfig": true
    },
  },
  "customizations": {
    "vscode": {
      "settings": {
        "terminal.integrated.profiles.linux": {
          "bash": {
            "path": "/bin/zsh"
          }
        },
        "terminal.integrated.defaultProfile.linux": "zsh",
        // change terminal fonnt size to 18
        "terminal.integrated.fontSize": 18,
        "files.autoSave": "onFocusChange",
        "nxConsole.generatorAllowlist": [
          "@nx/next",
          "@nx/cypress",
          "@nx/eslint",
          "@nx/js",
          "@nx/react",
          "@nx-tools/nx-container"
        ],
        "nxConsole.projectViewingStyle": "list",
        "WhiteSource Advise.Diff.BaseBranch": "main",
        "WhiteSource Advise.includeDevDependencies": true,
        "WhiteSource Advise.OnlyShowIssuesForDirectDependencies": true
      },
      "extensions": [
        "samuelcolvin.jinjahtml",
        "GitHub.copilot",
        "BenjaminBenais.copilot-theme",
        "donjayamanne.git-extension-pack",
        "ms-azuretools.vscode-docker",
        "firsttris.vscode-jest-runner",
        "nrwl.angular-console",
        "esbenp.prettier-vscode",
        "github.vscode-github-actions",
        "mrmlnc.vscode-json5",
        "Mend.mend-advise"
      ]
    }
  }
}
